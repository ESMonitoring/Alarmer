const names=[],codes=[];let alarm_text,selected_site_name=[],ES_site=[],codeNOES=[];var inf_state="شرح";$.getJSON("data.json",function(e){for(let t=0;t<Object.keys(e).length;t++)names[t]=e[t].name,codes[t]=e[t].code}),$(function(){$("#alarminput").autocomplete({source:["AC Fail","قطعی سایت","ریست سایت","AC Fail - Module Fail","Module Fail","Module Fail>2","AC Fail - Module Fail - Module Fail>2","RF Unit Maintenance Link Failure","High Temperature","NE Is Disconnected","Power supply DC Output Out Of Range","Low Battery","Door Open","Battery Low Voltage","ریست GSM","ریست LTE","Cell Logical Channel Failure","Battery Disconnect","VSWR - BAND:BBBB - SECTOR:Y - MAIN/DIVER - Value: X.Y"]}),$("#rep_to").autocomplete({source:["آقای کاوه","آقای شاهمرادی","خانم خدابخشیان","آقای نیری","آقای یزدانپرست","آقای زیباکلام","آقای مصری پور","آقای سرائیان","آقای عرب","آقای قربانی","آقای نصیری","آقای جنگروی","آقای هدایتی","آقای فریدونی","آقای خوانساری","آقای علیزاده","آقای ایزدی","آقای مرادی","آقای جودکی"]}),$("#more").autocomplete({source:["قطعی برق منطقه","PM-SITE","در حال پیگیری","ناپایداری لینک انتقال","اعزام کارشناس","CR#Number - موضوع - از ساعت XX الی YY - انجام دهنده: XXXX"]})});const copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};function preview_Maker(){codesite=document.getElementById("site_code").value,reportedto=document.getElementById("rep_to").value,monitoring=document.getElementById("monitoring").value,more_inf=document.getElementById("more").value,codeNOES=codesite.trim().split(/\s+/),ES_site=codeNOES.map(e=>`ES${e}`),time1=document.getElementById("time1").value,time2=document.getElementById("time2").value,name_searcher(ES_site,names,codes),text_maker()}function name_searcher(e,t,n){for(let o=0;o<e.length;o++)for(let a=0;a<n.length;a++)e[o]==n[a]?selected_site_name[o]=t[a]:selected_site_name[o]||(selected_site_name[o]="کد سایت اشتباه/ناموجود⭐")}document.getElementById("clear").addEventListener("click",function(){document.getElementById("site_code").value="",document.getElementById("alarminput").value="",document.getElementById("more").value="",document.getElementById("rep_to").value="",document.getElementById("time1").value="",document.getElementById("time2").value=""}),document.getElementById("preview").addEventListener("click",function(){preview_Maker()}),document.getElementById("rep_to").addEventListener("keyup",function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById("preview").click())}),window.addEventListener("beforeunload",function(e){e.preventDefault(),e.returnValue=""});var input=document.getElementById("sharh");function text_maker(){let e=(new Date).toLocaleDateString("fa-IR").replace(/([۰-۹])/g,e=>String.fromCharCode(e.charCodeAt(0)-1728));seperator=e.split("/"),e=`${seperator[0]}/${seperator[1].padStart(2,"0")}/${seperator[2].padStart(2,"0")}`;let t="";site_list=`${function(){for(let e=0;e<selected_site_name.length;e++)t+=`${selected_site_name[e]} - ${codeNOES[e]}\n`;return t}()}`,alarm_name=document.getElementById("alarminput").value,info_list=`${more_inf?`${inf_state}: ${more_inf}\n`:""}`,reportedto=`${reportedto?`گزارش به ${reportedto}\n`:""}`,siteha=`${codeNOES.length<2?"سایت: ":"سایت های:\n"}`,time_stamp=`${time2.trim()?`${time1.trim()} الی ${time2.trim()}`:time1}`,IsMonitorong=`${!1===document.getElementById("fixed_monitoring").checked?"":"مانیتورینگ: "}`,codesite.trim()||(site_list="کدسایتی وارد نشده است.\n"),alarm_text=`${e}\n${siteha}${site_list}آلارم: ${alarm_name}\nزمان: ${time_stamp}\n${info_list}${reportedto}${IsMonitorong}${monitoring}`,copyToClipboard(alarm_text),document.getElementById("pre_modal").textContent=alarm_text,document.getElementById("copybutton").textContent="کپی!",$("#myModal").modal(),selected_site_name.length=0,ES_site.length=0}input.addEventListener("change",function(){inf_state=this.checked?"شرح":"علت"}),document.getElementById("copybutton").addEventListener("click",function(){document.getElementById("copybutton").textContent="کپی شد!"});